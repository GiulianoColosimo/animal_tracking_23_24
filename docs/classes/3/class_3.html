<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-05-16">

<title>Animal-Tracking in Biologia della Conservazione — 2023/2024 - Animal tracking nella biologia della conservazione</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../.././figures/avatar.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="Animal-Tracking in Biologia della Conservazione — 2023/2024 - Animal tracking nella biologia della conservazione">
<meta property="og:description" content="Class 3">
<meta property="og:site_name" content="Animal-Tracking in Biologia della Conservazione — 2023/2024">
<meta property="og:locale" content="en_US">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Animal-Tracking in Biologia della Conservazione — 2023/2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contacts.html"> 
<span class="menu-text">Contacts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Animal tracking nella biologia della conservazione</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../.././figures/avatar.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="mailto:giuliano.colosimo@uniroma2.it" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/1/class_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 1 - Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/2/class_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/3/class_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/4/class_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/5/class_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/6/class_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/7/class_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 7</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#topics" id="toc-topics" class="nav-link active" data-scroll-target="#topics">Topics</a></li>
  <li><a href="#drivers-of-species-distribution" id="toc-drivers-of-species-distribution" class="nav-link" data-scroll-target="#drivers-of-species-distribution">Drivers of species distribution</a></li>
  <li><a href="#drivers-of-species-distribution-1" id="toc-drivers-of-species-distribution-1" class="nav-link" data-scroll-target="#drivers-of-species-distribution-1">Drivers of species distribution</a></li>
  <li><a href="#the-abiotic-environment" id="toc-the-abiotic-environment" class="nav-link" data-scroll-target="#the-abiotic-environment">The abiotic environment</a></li>
  <li><a href="#the-abiotic-environment-1" id="toc-the-abiotic-environment-1" class="nav-link" data-scroll-target="#the-abiotic-environment-1">The abiotic environment</a></li>
  <li><a href="#the-abiotic-environment-2" id="toc-the-abiotic-environment-2" class="nav-link" data-scroll-target="#the-abiotic-environment-2">The abiotic environment</a></li>
  <li><a href="#movement-pattern-analysis" id="toc-movement-pattern-analysis" class="nav-link" data-scroll-target="#movement-pattern-analysis">Movement pattern analysis</a></li>
  <li><a href="#movement-pattern-analysis-1" id="toc-movement-pattern-analysis-1" class="nav-link" data-scroll-target="#movement-pattern-analysis-1">Movement pattern analysis</a></li>
  <li><a href="#install-and-load-the-appropriate-toolset" id="toc-install-and-load-the-appropriate-toolset" class="nav-link" data-scroll-target="#install-and-load-the-appropriate-toolset">Install and load the appropriate toolset</a></li>
  <li><a href="#preliminary-data-analysis" id="toc-preliminary-data-analysis" class="nav-link" data-scroll-target="#preliminary-data-analysis">Preliminary data analysis</a></li>
  <li><a href="#preliminary-data-analysis-1" id="toc-preliminary-data-analysis-1" class="nav-link" data-scroll-target="#preliminary-data-analysis-1">Preliminary data analysis</a>
  <ul class="collapse">
  <li><a href="#basic-plots-1" id="toc-basic-plots-1" class="nav-link" data-scroll-target="#basic-plots-1">Basic plots 1</a></li>
  </ul></li>
  <li><a href="#preliminary-data-analysis-2" id="toc-preliminary-data-analysis-2" class="nav-link" data-scroll-target="#preliminary-data-analysis-2">Preliminary data analysis</a>
  <ul class="collapse">
  <li><a href="#basic-plots-2" id="toc-basic-plots-2" class="nav-link" data-scroll-target="#basic-plots-2">Basic plots 2</a></li>
  </ul></li>
  <li><a href="#preliminary-data-analysis-3" id="toc-preliminary-data-analysis-3" class="nav-link" data-scroll-target="#preliminary-data-analysis-3">Preliminary data analysis</a>
  <ul class="collapse">
  <li><a href="#plot-on-a-map" id="toc-plot-on-a-map" class="nav-link" data-scroll-target="#plot-on-a-map">Plot on a map</a></li>
  </ul></li>
  <li><a href="#preliminary-data-analysis-4" id="toc-preliminary-data-analysis-4" class="nav-link" data-scroll-target="#preliminary-data-analysis-4">Preliminary data analysis</a>
  <ul class="collapse">
  <li><a href="#plot-on-a-zoomed-map" id="toc-plot-on-a-zoomed-map" class="nav-link" data-scroll-target="#plot-on-a-zoomed-map">Plot on a zoomed map</a></li>
  </ul></li>
  <li><a href="#preliminary-data-analysis-5" id="toc-preliminary-data-analysis-5" class="nav-link" data-scroll-target="#preliminary-data-analysis-5">Preliminary data analysis</a>
  <ul class="collapse">
  <li><a href="#plot-on-a-google-map-background" id="toc-plot-on-a-google-map-background" class="nav-link" data-scroll-target="#plot-on-a-google-map-background">Plot on a google map background</a></li>
  </ul></li>
  <li><a href="#tidy-your-data" id="toc-tidy-your-data" class="nav-link" data-scroll-target="#tidy-your-data">Tidy your data</a></li>
  <li><a href="#tidy-your-data-1" id="toc-tidy-your-data-1" class="nav-link" data-scroll-target="#tidy-your-data-1">Tidy your data</a></li>
  <li><a href="#visualizing-data-for-vulture" id="toc-visualizing-data-for-vulture" class="nav-link" data-scroll-target="#visualizing-data-for-vulture">Visualizing data for vulture</a></li>
  <li><a href="#visualizing-data-for-vulture-1" id="toc-visualizing-data-for-vulture-1" class="nav-link" data-scroll-target="#visualizing-data-for-vulture-1">Visualizing data for vulture</a>
  <ul class="collapse">
  <li><a href="#check-and-tidy-data" id="toc-check-and-tidy-data" class="nav-link" data-scroll-target="#check-and-tidy-data">Check and tidy data</a></li>
  </ul></li>
  <li><a href="#visualizing-data-for-vulture-2" id="toc-visualizing-data-for-vulture-2" class="nav-link" data-scroll-target="#visualizing-data-for-vulture-2">Visualizing data for vulture</a>
  <ul class="collapse">
  <li><a href="#azimuthal-distribution-of-data" id="toc-azimuthal-distribution-of-data" class="nav-link" data-scroll-target="#azimuthal-distribution-of-data">Azimuthal distribution of data</a></li>
  </ul></li>
  <li><a href="#visualizing-data-for-vulture-3" id="toc-visualizing-data-for-vulture-3" class="nav-link" data-scroll-target="#visualizing-data-for-vulture-3">Visualizing data for vulture</a>
  <ul class="collapse">
  <li><a href="#azimuthal-distribution-of-data-1" id="toc-azimuthal-distribution-of-data-1" class="nav-link" data-scroll-target="#azimuthal-distribution-of-data-1">Azimuthal distribution of data</a></li>
  </ul></li>
  <li><a href="#visualizing-data-for-vulture-4" id="toc-visualizing-data-for-vulture-4" class="nav-link" data-scroll-target="#visualizing-data-for-vulture-4">Visualizing data for vulture</a>
  <ul class="collapse">
  <li><a href="#azimuthal-distribution-of-data-2" id="toc-azimuthal-distribution-of-data-2" class="nav-link" data-scroll-target="#azimuthal-distribution-of-data-2">Azimuthal distribution of data</a></li>
  </ul></li>
  <li><a href="#visualizing-data-for-vulture-5" id="toc-visualizing-data-for-vulture-5" class="nav-link" data-scroll-target="#visualizing-data-for-vulture-5">Visualizing data for vulture</a>
  <ul class="collapse">
  <li><a href="#azimuthal-distribution-of-data-3" id="toc-azimuthal-distribution-of-data-3" class="nav-link" data-scroll-target="#azimuthal-distribution-of-data-3">Azimuthal distribution of data</a></li>
  </ul></li>
  <li><a href="#visualizing-randomly-generated-data" id="toc-visualizing-randomly-generated-data" class="nav-link" data-scroll-target="#visualizing-randomly-generated-data">Visualizing randomly generated data</a>
  <ul class="collapse">
  <li><a href="#net-squared-displacement" id="toc-net-squared-displacement" class="nav-link" data-scroll-target="#net-squared-displacement">Net squared displacement</a></li>
  </ul></li>
  <li><a href="#visualizing-randomly-generated-data-1" id="toc-visualizing-randomly-generated-data-1" class="nav-link" data-scroll-target="#visualizing-randomly-generated-data-1">Visualizing randomly generated data</a>
  <ul class="collapse">
  <li><a href="#net-squared-displacement-1" id="toc-net-squared-displacement-1" class="nav-link" data-scroll-target="#net-squared-displacement-1">Net squared displacement</a></li>
  </ul></li>
  <li><a href="#visualizing-randomly-generated-data-2" id="toc-visualizing-randomly-generated-data-2" class="nav-link" data-scroll-target="#visualizing-randomly-generated-data-2">Visualizing randomly generated data</a>
  <ul class="collapse">
  <li><a href="#net-squared-displacement-2" id="toc-net-squared-displacement-2" class="nav-link" data-scroll-target="#net-squared-displacement-2">Net squared displacement</a></li>
  </ul></li>
  <li><a href="#visualizing-randomly-generated-data-3" id="toc-visualizing-randomly-generated-data-3" class="nav-link" data-scroll-target="#visualizing-randomly-generated-data-3">Visualizing randomly generated data</a>
  <ul class="collapse">
  <li><a href="#net-squared-displacement-3" id="toc-net-squared-displacement-3" class="nav-link" data-scroll-target="#net-squared-displacement-3">Net squared displacement</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="class_3.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Animal tracking nella biologia della conservazione</h1>
<p class="subtitle lead">Class 3</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="topics" class="level2">
<h2 class="anchored" data-anchor-id="topics">Topics</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><span style="color: green;">Setting up your computers</span>
<ul>
<li><span style="color: green;">Packages to install</span></li>
</ul></li>
<li><span style="color: green;">An introduction to Animal tracking</span>
<ul>
<li><span style="color: green;">Tagging systems</span></li>
</ul></li>
<li><span style="color: green;">CRS</span>
<ul>
<li><span style="color: green;">Telemetry and GPS</span></li>
</ul></li>
<li><span style="color: green;">Movement Data</span></li>
<li><span style="color: green;">On-line databases</span>
<ul>
<li><span style="color: green;">GBIF</span></li>
<li><span style="color: green;">Movebank</span></li>
</ul></li>
</ol>
</div><div class="column" style="width:50%;">
<ol start="6" type="1">
<li><span style="color: orange;">Drivers of species distribution</span></li>
<li><span style="color: GhostWhite;">Home range estimates</span>
<ul>
<li><span style="color: GhostWhite;">MPC</span></li>
<li><span style="color: GhostWhite;">KDE</span></li>
<li><span style="color: GhostWhite;">Kriging</span></li>
<li><span style="color: GhostWhite;">BBM</span></li>
</ul></li>
<li><span style="color: GhostWhite;">Species distribution modeling</span>
<ul>
<li><span style="color: GhostWhite;">Resource selection functions</span></li>
<li><span style="color: GhostWhite;">Step selection functions</span></li>
</ul></li>
<li><span style="color: GhostWhite;">Modeling approaches</span></li>
</ol>
</div>
</div>
</section>
<section id="drivers-of-species-distribution" class="level2">
<h2 class="anchored" data-anchor-id="drivers-of-species-distribution">Drivers of species distribution</h2>
<ul>
<li>Advances in ecological research have contributed to make the study and understanding of the distribution of biodiversity at various spatial and temporal scale a core aspect of macro-ecology and biodiversity research <span class="citation" data-cites="Guisan2020">(<a href="#ref-Guisan2020" role="doc-biblioref">Guisan, Thuiller, &amp; Zimmermann, 2020</a>)</span></li>
<li>Three main condition need to met in order for a species to occupy an area and maintain a viable population:
<ol type="1">
<li>the species has to reach the site</li>
<li>the abiotic conditions have to be suitable for the species</li>
<li>the biotic environment must be suitable for the species</li>
</ol></li>
</ul>
</section>
<section id="drivers-of-species-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="drivers-of-species-distribution-1">Drivers of species distribution</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./ecoProcesses.png" class="img-fluid figure-img"></p>
<figcaption>Figure 3.1 after <span class="citation" data-cites="Guisan2020">Guisan et al. (<a href="#ref-Guisan2020" role="doc-biblioref">2020</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="the-abiotic-environment" class="level2">
<h2 class="anchored" data-anchor-id="the-abiotic-environment">The abiotic environment</h2>
<ul>
<li>How does the abiotic environment influence the distribution of organisms?</li>
<li>What are the different types of environmental influences on species distribution?</li>
<li>How do multiple variables jointly determine a species geographic distribution?</li>
<li>Habitat: A description of environmental condition (abiotic and biotic) at a given locality at a particular scale of space and time, where organisms are or could potentially live</li>
<li>Species can colonize a range of conditions along an environmental gradient, but in most cases the range occupies a small portion of all possible conditions</li>
<li>The reasons lie in the physiology of organisms and the specific physiological adaptations that allow certain species to be better competitors in certain habitats and worst competitors in other</li>
</ul>
</section>
<section id="the-abiotic-environment-1" class="level2">
<h2 class="anchored" data-anchor-id="the-abiotic-environment-1">The abiotic environment</h2>
<ul>
<li>The transition from optimal to poor performance in a specific habitat can be a smooth transition or an abrupt transition</li>
<li>In conifer tree, the cambium activity allowing root growth tend to stop rather abruptly below ca. 7ºC at 10cm below ground <span class="citation" data-cites="Korner2021">(<a href="#ref-Korner2021" role="doc-biblioref">Körner, 2021</a>)</span></li>
<li>Smoother transitions occur when the gradient has a linear effect on some metabolic rate, progressively lowering individual fitness</li>
<li>All important variables should be considered jointly in an analysis in order to define what is known as the environmental niche of a species</li>
<li>When considered jointly, the physiological responses of a given species to several environmental variables define a multidimensional volume called a species fundamental environmental niche</li>
<li>For plants, the axes of the fundamental niche may typically be resource variable related to light, heat, water and nutrient variability <span class="citation" data-cites="Guisan2020">(<a href="#ref-Guisan2020" role="doc-biblioref">Guisan et al., 2020</a>)</span></li>
</ul>
</section>
<section id="the-abiotic-environment-2" class="level2">
<h2 class="anchored" data-anchor-id="the-abiotic-environment-2">The abiotic environment</h2>
<ul>
<li><p>If we could estimate the species fundamental niche we would be able to make predictions about where the species could live and thrive</p></li>
<li><p>In practice, measuring the fundamental niche based on field observation is practically impossible as interactions with other species should be factored in</p></li>
<li><p>The response of species in nature is modified by the presence of other species within the same group or across groups combined with the effects of the changing environment.These effects constrint the fundamental niche to what is known as the realized niche</p></li>
<li><p>Sometimes is not possible to measure and map the variables that actually have a measurable effect on species distribution</p></li>
</ul>
</section>
<section id="movement-pattern-analysis" class="level2">
<h2 class="anchored" data-anchor-id="movement-pattern-analysis">Movement pattern analysis</h2>
<ul>
<li>Azimuth and turning angles:
<ul>
<li>direction of travel, directionality of movement, and relation to speed</li>
<li>recommended to exclude stationary segments from analysis</li>
</ul></li>
<li>Net square displacement (NSD):
<ul>
<li>quantifies the net squared distance traveled over time compared to an point of reference (calculates distance from each location to the point of reference)</li>
<li>point of reference (nest, den, colony) needed. If there is no point of reference, or animal is nomadic, use e.g.&nbsp;FPT</li>
</ul></li>
</ul>
</section>
<section id="movement-pattern-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="movement-pattern-analysis-1">Movement pattern analysis</h2>
<ul>
<li>First Time Passage (FTP)
<ul>
<li>calculates the time it takes to cross a circle of a given radius, i.e.&nbsp;time the animal spends in a given area at a certain spatial scale (”draws” circle around each point and calculates how long it takes to leave the circle)</li>
<li>the variance of log(fpt) can inform about the scales at which processes are likely to be changing</li>
<li>the slopes of the log(meanFPT) ∼ log(radii), can indicate the type of movement at each scale. Flatter slopes indicate more directional movement, steeper slopes more brownian movement</li>
</ul></li>
</ul>
</section>
<section id="install-and-load-the-appropriate-toolset" class="level2">
<h2 class="anchored" data-anchor-id="install-and-load-the-appropriate-toolset">Install and load the appropriate toolset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"move"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mapdata"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggmap"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mapproj"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggsn"</span>) <span class="co"># or devtools::install_github('oswaldosantos/ggsn')</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"circular"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"adehabitatLT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>We can now load all the libraries that are going to be needed to run the exercise</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(move)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: geosphere</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: raster</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'raster'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotly':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:raster':

    intersect, select, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maps</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotrix':

    rescale</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Google's Terms of Service: &lt;https://mapsplatform.google.com&gt;
  Stadia Maps' Terms of Service: &lt;https://stadiamaps.com/terms-of-service/&gt;
  OpenStreetMap's Tile Usage Policy: &lt;https://operations.osmfoundation.org/policies/tiles/&gt;
ℹ Please cite ggmap if you use it! Use `citation("ggmap")` for details.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggmap'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotly':

    wind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Please note that 'maptools' will be retired during October 2023,
plan transition at your earliest convenience (see
https://r-spatial.org/r/2023/05/15/evolution4.html and earlier blogs
for guidance);some functionality will be moved to 'sp'.
 Checking rgeos availability: TRUE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggsn'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:raster':

    scalebar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:raster':

    intersect, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circular)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'circular'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggmap':

    wind</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotly':

    wind</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    sd, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adehabitatLT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ade4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: adehabitatMA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'adehabitatMA':
  method                       from
  print.SpatialPixelsDataFrame sp  
  print.SpatialPixels          sp  </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'adehabitatMA'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:raster':

    buffer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: CircStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:raster':

    area, select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotly':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: boot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'CircStats'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:circular':

    A1, A1inv, deg, I.0, I.1, I.p, pp.plot, rad, rose.diag, rstable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'adehabitatLT'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    id</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:move':

    burst</code></pre>
</div>
</div>
</section>
<section id="preliminary-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis">Preliminary data analysis</h2>
<ul>
<li>Use <a href="https://drive.proton.me/urls/JKGD8SYASR#qYRvkKaVjr10">this</a> link to download a .csv file with with the dataset we will be using</li>
<li>Place the dataset in a directory where you will be working</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">### We read in this dataset downloaded from Movebank directly as a move2 object</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>bats <span class="ot">&lt;-</span> <span class="fu">move</span>(<span class="st">"/PATH TO YOUR DIRECTORY/Parti-colored bat Safi Switzerland.csv"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Formal class 'MoveStack' [package "move"] with 17 slots
  ..@ trackId                : Factor w/ 17 levels "X21","X42","X127",..: 1 1 1 1 1 1 1 1 1 1 ...
  ..@ timestamps             : POSIXct[1:1740], format: "2002-06-02 22:55:11" "2002-06-02 23:04:30" ...
  ..@ idData                 :'data.frame': 17 obs. of  7 variables:
  .. ..$ visible                        : Factor w/ 1 level "true": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ manually.marked.outlier        : logi [1:17] NA NA NA NA NA NA ...
  .. ..$ sensor.type                    : Factor w/ 1 level "radio-transmitter": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ individual.taxon.canonical.name: Factor w/ 1 level "Vespertilio murinus": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ tag.local.identifier           : Factor w/ 17 levels "#1918725","#1918728",..: 8 9 10 11 12 1 2 3 13 4 ...
  .. ..$ individual.local.identifier    : Factor w/ 17 levels "X21","X42","X127",..: 1 2 3 4 5 6 7 8 9 10 ...
  .. ..$ study.name                     : Factor w/ 1 level "Parti-colored bat Safi Switzerland": 1 1 1 1 1 1 1 1 1 1 ...
  ..@ sensor                 : Factor w/ 1 level "radio-transmitter": 1 1 1 1 1 1 1 1 1 1 ...
  ..@ data                   :'data.frame': 1740 obs. of  2 variables:
  .. ..$ event.id : int [1:1740] 16309975 16309976 16309877 16309874 16309878 16309886 16309887 16309888 16309889 16309890 ...
  .. ..$ timestamp: POSIXct[1:1740], format: "2002-06-02 22:55:11" "2002-06-02 23:04:30" ...
  ..@ coords.nrs             : int [1:2] 3 4
  ..@ coords                 : num [1:1740, 1:2] 8.6 8.61 8.61 8.6 8.6 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:1740] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:2] "location.long" "location.lat"
  ..@ bbox                   : num [1:2, 1:2] 7.03 46.9 8.69 47.66
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "location.long" "location.lat"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string            :Formal class 'CRS' [package "sp"] with 1 slot
  .. .. ..@ projargs: chr "+proj=longlat +datum=WGS84 +no_defs"
  .. .. ..$ comment: chr "GEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.25722"| __truncated__
  ..@ trackIdUnUsedRecords   : Factor w/ 17 levels "X21","X42","X127",..: 
  ..@ timestampsUnUsedRecords: 'POSIXct' num(0) 
 - attr(*, "tzone")= chr "UTC"
  ..@ sensorUnUsedRecords    : Factor w/ 1 level "radio-transmitter": 
  ..@ dataUnUsedRecords      :'data.frame': 0 obs. of  4 variables:
  .. ..$ event.id     : int(0) 
  .. ..$ timestamp    : 'POSIXct' num(0) 
 - attr(*, "tzone")= chr "UTC"
  .. ..$ location.long: num(0) 
  .. ..$ location.lat : num(0) 
  ..@ dateCreation           : POSIXct[1:1], format: "2023-07-07 03:20:52"
  ..@ study                  : chr "Parti-colored bat Safi Switzerland"
  ..@ citation               : chr(0) 
  ..@ license                : chr(0) </code></pre>
</div>
</div>
</section>
<section id="preliminary-data-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis-1">Preliminary data analysis</h2>
<section id="basic-plots-1" class="level3">
<h3 class="anchored" data-anchor-id="basic-plots-1">Basic plots 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/pda2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="preliminary-data-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis-2">Preliminary data analysis</h2>
<section id="basic-plots-2" class="level3">
<h3 class="anchored" data-anchor-id="basic-plots-2">Basic plots 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bats, <span class="at">xlab=</span><span class="st">"Longitude"</span>, <span class="at">ylab=</span><span class="st">"Latitude"</span>, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/pda3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="preliminary-data-analysis-3" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis-3">Preliminary data analysis</h2>
<section id="plot-on-a-map" class="level3">
<h3 class="anchored" data-anchor-id="plot-on-a-map">Plot on a map</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">'worldHires'</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">fill=</span>T)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">t</span>(<span class="fu">colMeans</span>(<span class="fu">coordinates</span>(bats))), <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">'red'</span>,<span class="fl">0.5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">t</span>(<span class="fu">colMeans</span>(<span class="fu">coordinates</span>(bats))), <span class="at">col=</span><span class="st">'cyan'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/pda4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="preliminary-data-analysis-4" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis-4">Preliminary data analysis</h2>
<section id="plot-on-a-zoomed-map" class="level3">
<h3 class="anchored" data-anchor-id="plot-on-a-zoomed-map">Plot on a zoomed map</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(e<span class="ot">&lt;-</span><span class="fu">bbox</span>(<span class="fu">extent</span>(bats)<span class="sc">*</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         min      max
s1  3.691055 12.02844
s2 45.388508 49.16696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note here that the brackets around the assignment ensure that the result is also printed to the console</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">'worldHires'</span>, <span class="at">xlim =</span> e[<span class="dv">1</span>, ], <span class="at">ylim =</span> e[<span class="dv">2</span>, ])</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(bats)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(bats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/pda5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="preliminary-data-analysis-5" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis-5">Preliminary data analysis</h2>
<section id="plot-on-a-google-map-background" class="level3">
<h3 class="anchored" data-anchor-id="plot-on-a-google-map-background">Plot on a google map background</h3>
<ul>
<li>This code is not shown because it won’t work for you unless you activate your personal google API key</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>! Bounding box given to Google - spatial extent only approximate.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ &lt;https://maps.googleapis.com/maps/api/staticmap?center=47.277732,7.859746&amp;zoom=9&amp;size=640x640&amp;scale=2&amp;maptype=terrain&amp;language=en-EN&amp;key=xxx&gt;</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/api-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tidy-your-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-your-data">Tidy your data</h2>
<ul>
<li>We can identify and remove outliers after a graphical inspection of our data</li>
<li>Download a new data set from <a href="https://drive.proton.me/urls/Z8YWTNZET8#lg4QAn0g2Qgk">this link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"PATH_TO_YOUR_DATA/buffalo_cleaned.Rdata"</span>) <span class="co"># buffalo</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Create gray scale</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>buffaloGray<span class="ot">&lt;-</span><span class="fu">gray</span>((<span class="fu">nrow</span>(<span class="fu">idData</span>(buffalo))<span class="sc">-</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">0</span><span class="sc">/</span><span class="fu">nrow</span>(<span class="fu">idData</span>(buffalo)))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot with gray scale</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(buffalo, <span class="at">col=</span>buffaloGray, <span class="at">xlab=</span><span class="st">"Longitude"</span>, <span class="at">ylab=</span><span class="st">"Latitude"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/tidyPoints2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tidy-your-data-1" class="level2">
<h2 class="anchored" data-anchor-id="tidy-your-data-1">Tidy your data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get the position of the coordinate that has the max longitude</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">coordinates</span>(buffalo)[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24606</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## drop the point with the largest coordinate values</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>buffalo <span class="ot">&lt;-</span> buffalo[<span class="sc">-</span><span class="fu">which.max</span>(<span class="fu">coordinates</span>(buffalo)[,<span class="dv">1</span>])]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(buffalo, <span class="at">col=</span>buffaloGray, <span class="at">xlab=</span><span class="st">"Longitude"</span>, <span class="at">ylab=</span><span class="st">"Latitude"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/tidyPoints3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## save the clean dataset for the following days</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(buffalo, <span class="at">file=</span><span class="st">"PATH_TO_YOUR_DIRECTORY/buffalos.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-data-for-vulture" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture">Visualizing data for vulture</h2>
<ul>
<li>Download the <a href="https://drive.proton.me/urls/0ME89QYNS4#AY9gJIEXEqqq">Leo</a> dataset and put it in your working directory</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>Leo <span class="ot">&lt;-</span> <span class="fu">move</span>(<span class="st">"PATH/TO/FILE/Leo-65545.csv.gz"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Leo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>class       : Move 
features    : 35256 
extent      : -108.8262, -68.58033, 7.16283, 53.82783  (xmin, xmax, ymin, ymax)
crs         : +proj=longlat +datum=WGS84 +no_defs 
variables   : 10
names       :  event.id,  timestamp, ground.speed, heading, height.raw, http...vocabulary.movebank.org.extended.raptor.workshop.attributes.migration.state,      utm.easting,     utm.northing, utm.zone, study.local.timestamp 
min values  :   2333006, 1182024000,            0,       0,          0,                                                                                   , 169798.059287902, 791836.814945502,      12N,            1181991600 
max values  : 180011334, 1363680000,          110,     359,       1982,                                                                    SpringMigration, 829886.257338918, 5967229.98624054,      19N,            1363651200 
timestamps  : 2007-06-16 20:00:00 ... 2013-03-19 08:00:00 Time difference of 2102 days  (start ... end, duration) 
sensors     : gps 
indiv. data : behavioural.classification, manually.marked.outlier, http...vocabulary.movebank.org.extended.raptor.workshop.attributes.behaviour, http...vocabulary.movebank.org.extended.raptor.workshop.attributes.deployment.special.event, visible, sensor.type, individual.taxon.canonical.name, tag.local.identifier, individual.local.identifier, study.name, study.timezone 
indiv. value: NA NA NA NA true gps Cathartes aura 65545 Leo Turkey Vulture Acopian Center USA GPS Pacific Standard Time 
study name  : Turkey Vulture Acopian Center USA GPS 
date created: 2023-07-07 03:20:52 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">'worldHires'</span>, <span class="at">xlim =</span> Leo<span class="sc">@</span>bbox[<span class="dv">1</span>, ]<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">ylim =</span> Leo<span class="sc">@</span>bbox[<span class="dv">2</span>, ]<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">col=</span><span class="st">"grey"</span>, <span class="at">fill=</span>T)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Leo, <span class="at">col=</span><span class="st">"firebrick"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/leo3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualizing-data-for-vulture-1" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture-1">Visualizing data for vulture</h2>
<section id="check-and-tidy-data" class="level3">
<h3 class="anchored" data-anchor-id="check-and-tidy-data">Check and tidy data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get locations per year and month</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(<span class="fu">timestamps</span>(Leo), <span class="fu">list</span>(<span class="fu">year</span>(<span class="fu">timestamps</span>(Leo)), <span class="fu">month</span>(<span class="fu">timestamps</span>(Leo))), length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1   2   3   4   5   6   7   8   9  10  11  12
2007  NA  NA  NA  NA  NA 300 699 701 698 717 658 677
2008 716 626 685 705 710 701 713 727 705 687 621 672
2009 643 579 648 671 616 510 641 728 702 706 660 622
2010 680 562 558 556 537 502 721 683 639 706 599 640
2011 601 586 649 609 563 344 541 706 667 307  NA  NA
2012  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 321 444
2013 432 404 255  NA  NA  NA  NA  NA  NA  NA  NA  NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">## removing years 2012-13 because there is a large gap</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Leo <span class="ot">&lt;-</span> Leo[<span class="fu">year</span>(Leo<span class="sc">$</span>timestamp)<span class="sc">&lt;</span><span class="dv">2012</span>,]</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(<span class="fu">timestamps</span>(Leo), <span class="fu">list</span>(<span class="fu">year</span>(<span class="fu">timestamps</span>(Leo)), <span class="fu">month</span>(<span class="fu">timestamps</span>(Leo))), length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1   2   3   4   5   6   7   8   9  10  11  12
2007  NA  NA  NA  NA  NA 300 699 701 698 717 658 677
2008 716 626 685 705 710 701 713 727 705 687 621 672
2009 643 579 648 671 616 510 641 728 702 706 660 622
2010 680 562 558 556 537 502 721 683 639 706 599 640
2011 601 586 649 609 563 344 541 706 667 307  NA  NA</code></pre>
</div>
</div>
</section>
</section>
<section id="visualizing-data-for-vulture-2" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture-2">Visualizing data for vulture</h2>
<section id="azimuthal-distribution-of-data" class="level3">
<h3 class="anchored" data-anchor-id="azimuthal-distribution-of-data">Azimuthal distribution of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>categories<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"Wintering"</span>, <span class="st">"2"</span><span class="ot">=</span><span class="st">"Wintering"</span>, </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"3"</span><span class="ot">=</span><span class="st">"Wintering"</span>, <span class="st">"4"</span><span class="ot">=</span><span class="st">"North migration"</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"5"</span><span class="ot">=</span><span class="st">"North migration"</span>, <span class="st">"6"</span><span class="ot">=</span><span class="st">"Breeding"</span>, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"7"</span><span class="ot">=</span><span class="st">"Breeding"</span>, <span class="st">"8"</span><span class="ot">=</span><span class="st">"Breeding"</span>, </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"9"</span><span class="ot">=</span><span class="st">"South migration"</span>, <span class="st">"10"</span><span class="ot">=</span><span class="st">"South migration"</span>, </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"11"</span><span class="ot">=</span><span class="st">"Wintering"</span>, <span class="st">"12"</span><span class="ot">=</span><span class="st">"Wintering"</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assign the categories to a new variable based on the timestamp</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>Leo<span class="sc">$</span>cat<span class="ot">&lt;-</span><span class="fu">factor</span>(categories[<span class="fu">month</span>(<span class="fu">timestamps</span>(Leo))],</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"South migration"</span>, <span class="st">"Wintering"</span>, <span class="st">"North migration"</span>, <span class="st">"Breeding"</span>))</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign NA to segments where subsequent locations fall in different seasons</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>Leo<span class="sc">$</span>cat[<span class="fu">c</span>(Leo<span class="sc">$</span>cat[<span class="sc">-</span><span class="fu">n.locs</span>(Leo)]<span class="sc">!=</span>Leo<span class="sc">$</span>cat[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">TRUE</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># store the information in a new data frame</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>azimuth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">D=</span><span class="fu">angle</span>(Leo),</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">V=</span><span class="fu">speed</span>(Leo), </span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Season=</span>Leo<span class="sc">$</span>cat[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualizing-data-for-vulture-3" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture-3">Visualizing data for vulture</h2>
<section id="azimuthal-distribution-of-data-1" class="level3">
<h3 class="anchored" data-anchor-id="azimuthal-distribution-of-data-1">Azimuthal distribution of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the direction as a circular</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>azimuth<span class="sc">$</span>Dcirc<span class="ot">&lt;-</span><span class="fu">as.circular</span>(azimuth<span class="sc">$</span>D, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rotation=</span><span class="st">"clock"</span>, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">units=</span><span class="st">"degrees"</span>, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type=</span><span class="st">"angles"</span>, </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">modulo=</span><span class="st">"asis"</span>, </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zero=</span><span class="dv">0</span>, </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">template=</span><span class="st">"geographic"</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># select segments above 2 m/s, we are only interested in segments when Leo is moving, and not the stationary error</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>azimuth <span class="ot">&lt;-</span> azimuth[azimuth<span class="sc">$</span>V<span class="sc">&gt;=</span><span class="dv">2</span>,]</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove missing values</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>azimuth <span class="ot">&lt;-</span> azimuth[<span class="fu">complete.cases</span>(azimuth),]</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector that is used to set the order of plotting</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>seasons <span class="ot">&lt;-</span> <span class="fu">levels</span>(Leo<span class="sc">$</span>cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualizing-data-for-vulture-4" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture-4">Visualizing data for vulture</h2>
<section id="azimuthal-distribution-of-data-2" class="level3">
<h3 class="anchored" data-anchor-id="azimuthal-distribution-of-data-2">Azimuthal distribution of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change margins of plot</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot all the azimuths</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(azimuth<span class="sc">$</span>Dcirc, <span class="at">stack=</span>T, <span class="at">shrink=</span><span class="fl">1.6</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">sep=</span><span class="fl">0.05</span>, <span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through seasons and plot a line denisty per season</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(seasons)){</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the azimuth</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> azimuth[azimuth<span class="sc">$</span>Season<span class="sc">==</span>seasons[i],<span class="st">'Dcirc'</span>]</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate density and plot as a line</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">bw=</span><span class="dv">180</span>, <span class="at">kernel=</span><span class="st">"vonmises"</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span>i)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw an arrow showing mean and resultant length</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows.circular</span>(<span class="fu">mean</span>(x), <span class="at">y=</span><span class="fu">rho.circular</span>(x), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">lty=</span>i)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), seasons, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">cex=</span><span class="fl">0.85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualizing-data-for-vulture-5" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data-for-vulture-5">Visualizing data for vulture</h2>
<section id="azimuthal-distribution-of-data-3" class="level3">
<h3 class="anchored" data-anchor-id="azimuthal-distribution-of-data-3">Azimuthal distribution of data</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/leo8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-randomly-generated-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-randomly-generated-data">Visualizing randomly generated data</h2>
<section id="net-squared-displacement" class="level3">
<h3 class="anchored" data-anchor-id="net-squared-displacement">Net squared displacement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate 500 tracks with 1000 steps, with different levels of correlation of turning angles (r) </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and convert into move object</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>sets <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rep</span>((<span class="fl">0.8</span> <span class="sc">+</span> <span class="fu">log10</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>, <span class="at">length.out=</span><span class="dv">10</span>)))<span class="sc">/</span><span class="dv">10</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>],<span class="dv">500</span>))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>rCRW <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">lapply</span>(sets, simm.crw, <span class="at">date=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">h=</span><span class="dv">1</span>), as, <span class="st">"Move"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate NSD for all tracks, from origin of trajectory</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>rNSD <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(rCRW, coordinates), spDistsN1, <span class="at">pt=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)), <span class="st">"^"</span>, <span class="dv">2</span>))</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>mNSD <span class="ot">&lt;-</span> <span class="fu">tapply</span>(rNSD, <span class="fu">list</span>(<span class="fu">sort</span>(<span class="fu">rep</span>(sets,<span class="dv">1000</span>)), <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="fu">length</span>(sets))), mean)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>) <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1300</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mNSD)),</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Step"</span>, <span class="at">ylab=</span><span class="st">"Net square distance"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>,<span class="dv">400</span>,<span class="dv">600</span>,<span class="dv">800</span>,<span class="dv">1000</span>))</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(mNSD), <span class="dv">1</span>, lines, <span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1250</span>, <span class="dv">1100</span>), <span class="at">length.out=</span><span class="fu">length</span>(<span class="fu">row.names</span>(mNSD))), mNSD[,<span class="fu">ncol</span>(mNSD)]), </span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">paste</span>(<span class="st">"r="</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">row.names</span>(mNSD)),<span class="dv">3</span>)),<span class="at">sep=</span><span class="st">""</span>), <span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualizing-randomly-generated-data-1" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-randomly-generated-data-1">Visualizing randomly generated data</h2>
<section id="net-squared-displacement-1" class="level3">
<h3 class="anchored" data-anchor-id="net-squared-displacement-1">Net squared displacement</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-randomly-generated-data-2" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-randomly-generated-data-2">Visualizing randomly generated data</h2>
<section id="net-squared-displacement-2" class="level3">
<h3 class="anchored" data-anchor-id="net-squared-displacement-2">Net squared displacement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - r=0.99: very correlated, movement almost in a steady direction, it's walking away from the origin.</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rCRW[[<span class="dv">4500</span>]], <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(rCRW[[<span class="dv">4500</span>]][<span class="dv">1</span>], <span class="at">col=</span><span class="st">"green3"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(rCRW[[<span class="dv">4500</span>]][<span class="dv">1000</span>], <span class="at">col=</span><span class="st">"red"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-randomly-generated-data-3" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-randomly-generated-data-3">Visualizing randomly generated data</h2>
<section id="net-squared-displacement-3" class="level3">
<h3 class="anchored" data-anchor-id="net-squared-displacement-3">Net squared displacement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - r=0.8: fairly correlated. movement is wiggly. For example:</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rCRW[[<span class="dv">1</span>]], <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(rCRW[[<span class="dv">1</span>]][<span class="dv">1</span>], <span class="at">col=</span><span class="st">"green3"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(rCRW[[<span class="dv">1</span>]][<span class="dv">1000</span>], <span class="at">col=</span><span class="st">"red"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="class_3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Guisan2020" class="csl-entry" role="listitem">
Guisan, A., Thuiller, W., &amp; Zimmermann, N. E. (2020). <em><a href="https://doi.org/10.1002/jwmg.21868"><span class="nocase">Habitat Suitability and Distribution Models (With Applications in R)</span></a></em>. Ecology, biodiversity and conservation (p. 462). Cambridge, United Kingdom: Cambridge University Press.
</div>
<div id="ref-Korner2021" class="csl-entry" role="listitem">
Körner, C. (2021). <em>Alpine plant life: Functional plant ecology of high mountain ecosystems</em>. Springer International Publishing. Retrieved from <a href="http://dx.doi.org/10.1007/978-3-030-59538-8">http://dx.doi.org/10.1007/978-3-030-59538-8</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/giulianocolosimo\.github\.io\/animal_tracking_23_24\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2023 Giuliano Colosimo</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>. Inspiration for this site comes from <a href="https://www.mm218.dev">here</a></p>
</div>
  </div>
</footer>




</body></html>